# Go-Project
# Go 网络聊天室 (Online Chat Room)

一个使用 **Go 语言** 编写的 TCP 网络聊天室，支持多人在线聊天、私聊、查看在线用户，以及 **心跳检测机制** 保证客户端存活。

---

## ✨ 功能特性

- ✅ **多人在线聊天**：所有用户共享公共聊天室。
- ✅ **私聊功能**：使用 `To:用户名-->消息` 可以点对点聊天。
- ✅ **查看在线用户**：输入 `list` 查看当前在线用户。
- ✅ **退出聊天室**：输入 `quit` 退出。
- ✅ **心跳检测**：
  - 客户端每 10 秒发送一次 `PING`。
  - 服务端收到 `PING` 回复 `PONG` 并刷新最后心跳时间。
  - 服务端每 15 秒检查一次客户端心跳，若 **30 秒未收到心跳**，则强制断开该用户连接。

---

## 📂 项目结构

.
├── client.go # 客户端代码
├── server.go # 服务端代码
├── utils.go # 消息收发工具函数（带长度前缀）
└── README.md # 项目说明文档


---

## 🚀 运行方法

### 1. 启动服务端
```bash
go run server.go
服务端默认监听 localhost:8080。

2. 启动客户端
在另一个终端中运行：

go run client.go
输入昵称后即可加入聊天室。

🖥️ 使用示例

-------------欢迎来到网络聊天室-------------
请输入你的网名:
张三
成功加入聊天室，可以开始聊天了...
可用命令：
输入：list 查看在线用户...
输入：quit 退出聊天室...
输入：To:+用户名-->+内容 私聊...

张三: 大家好！
李四: 你好，张三！

# 私聊示例

To:李四-->你好，我是张三

心跳日志示例：

客户端：

// [心跳] 已发送 PING
// [心跳] 收到服务器响应: PONG

服务端：

// [心跳] 收到 张三 的 PING
// [心跳] 已向 张三 回复 PONG
⚙️ 开发说明
# utils.go
封装了 SendMessage 与 ReadMessage，实现了带长度前缀的安全消息收发。

# 心跳检测实现

客户端：startHeartbeat 每 10 秒发送 PING。

服务端：在 handleClient 中处理 PING 并回复 PONG。

服务端 heart 协程每 15 秒检查一次，若 30 秒未收到心跳则踢出。

# 健壮性

在 handleClient 和 handleEvent 中加入 panic 恢复 (recover) 防止崩溃。
